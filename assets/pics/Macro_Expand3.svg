<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- 由 Microsoft Visio, SVG Export 生成 Macro_Expand3.svg Page-1 -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"
		width="7.39973in" height="9.81493in" viewBox="0 0 532.78 706.675" xml:space="preserve" color-interpolation-filters="sRGB"
		class="st15">
	<style type="text/css">
	<![CDATA[
		.st1 {fill:#d80073;stroke:#ffffff;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.5}
		.st2 {fill:#ffffff;font-family:微软雅黑;font-size:1.00001em;letter-spacing:0.0499996em}
		.st3 {marker-end:url(#mrkr5-12);stroke:#1485bc;stroke-linecap:butt;stroke-width:1}
		.st4 {fill:#1485bc;fill-opacity:1;stroke:#1485bc;stroke-opacity:1;stroke-width:0.28409090909091}
		.st5 {fill:#ffffff;stroke:none;stroke-linecap:butt;stroke-width:7.2}
		.st6 {fill:#1485bb;font-family:Segoe UI;font-size:0.666664em}
		.st7 {fill:#1ba1e2;stroke:#ffffff;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.5}
		.st8 {font-size:1em}
		.st9 {fill:#339933}
		.st10 {stroke:#ffffff;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.5}
		.st11 {fill:none;stroke:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:1}
		.st12 {fill:#b47006;font-family:微软雅黑;font-size:0.666664em}
		.st13 {fill:#ffc000;font-family:微软雅黑;font-size:1.00001em;font-weight:bold;letter-spacing:0.0499996em}
		.st14 {fill:#ffffff;font-size:1em;font-weight:normal}
		.st15 {fill:none;fill-rule:evenodd;font-size:12px;overflow:visible;stroke-linecap:square;stroke-miterlimit:3}
	]]>
	</style>

	<defs id="Markers">
		<g id="lend5">
			<path d="M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67173 -0.364515 1.67301 0.372641 1.98465 1.00043 " style="stroke:none"/>
		</g>
		<marker id="mrkr5-12" class="st4" refX="-6.16" orient="auto" markerUnits="strokeWidth" overflow="visible">
			<use xlink:href="#lend5" transform="scale(-3.52,-3.52) "/>
		</marker>
	</defs>
	<g>
		<title>页-1</title>
		<g id="shape6-1" transform="translate(57.4773,-479.24)">
			<title>Decision</title>
			<desc>宏列表非空</desc>
			<path d="M0 685.42 L64.49 664.16 L128.98 685.42 L64.49 706.67 L0 685.42 Z" class="st1"/>
			<text x="32.99" y="689.02" class="st2">宏列表非空</text>		</g>
		<g id="shape10-4" transform="translate(388.422,-567.98)">
			<title>Start/End.8</title>
			<desc>返回当前字符串</desc>
			<path d="M14.17 706.67 L87.87 706.67 A14.1732 14.1732 -180 1 0 87.87 678.33 L14.17 678.33 A14.1732 14.1732 -180 1 0 14.17
						 706.67 Z" class="st1"/>
			<text x="6.92" y="696.1" class="st2">返回当前字符串</text>		</g>
		<g id="shape26-7" transform="translate(114.879,-479.24)">
			<title>动态连接线</title>
			<desc>Y</desc>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
			<rect x="4.87568" y="718.051" width="4.42172" height="9.59985" class="st5"/>
			<text x="4.88" y="725.25" class="st6">Y</text>		</g>
		<g id="shape27-15" transform="translate(216.217,-104.886)">
			<title>Process.27</title>
			<desc>使用参数token原始字符串字面量形式替换</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="2.47" y="681.82" class="st2">使用参数token原始字<tspan x="7.79" dy="1.2em" class="st8">符串字面量形式替换</tspan></text>		</g>
		<g id="shape28-19" transform="translate(388.422,-37.1022)">
			<title>Decision.28</title>
			<desc>存在#或##</desc>
			<path d="M0 685.42 L51.02 664.16 L102.05 685.42 L51.02 706.67 L0 685.42 Z" class="st1"/>
			<text x="19.74" y="689.02" class="st2">存在#或##</text>		</g>
		<g id="shape37-22" transform="translate(374.958,-104.886)">
			<title>Process.37</title>
			<desc>使用参数token进行宏展开后的结果替换</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="2.47" y="681.82" class="st2">使用参数token进行宏<tspan x="14.09" dy="1.2em" class="st8">展开后的结果替换</tspan></text>		</g>
		<g id="shape38-26" transform="translate(432.359,-79.6219)">
			<title>动态连接线.38</title>
			<desc>N</desc>
			<path d="M7.09 706.67 L7.09 687.57" class="st3"/>
			<rect x="4.09455" y="689.243" width="5.98425" height="9.59985" class="st5"/>
			<text x="4.09" y="696.44" class="st6">N</text>		</g>
		<g id="shape44-33" transform="translate(57.4773,-500.5)">
			<title>动态连接线.44</title>
			<desc>N</desc>
			<path d="M0 706.67 L-21.26 706.67 L-21.26 664.16 L61.49 664.16 A3 3 0 0 1 67.49 664.16 L381.97 664.16 L381.97 645.35"
					class="st3"/>
			<rect x="157.953" y="659.355" width="5.98425" height="9.59985" class="st5"/>
			<text x="157.95" y="666.56" class="st6">N</text>		</g>
		<g id="shape55-40" transform="translate(114.879,-554.111)">
			<title>动态连接线.55</title>
			<desc>Y</desc>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
			<rect x="4.87568" y="718.051" width="4.42172" height="9.59985" class="st5"/>
			<text x="4.88" y="725.25" class="st6">Y</text>		</g>
		<g id="shape59-47" transform="translate(57.4773,-642.547)">
			<title>Start/End.59</title>
			<desc>展开字符串中的宏</desc>
			<path d="M14.17 706.67 L114.8 706.67 A14.1732 14.1732 -180 0 0 114.8 678.33 L14.17 678.33 A14.1732 14.1732 -180 1 0 14.17
						 706.67 Z" class="st1"/>
			<text x="14.09" y="696.1" class="st2">展开字符串中的宏</text>		</g>
		<g id="shape60-50" transform="translate(374.958,-186.844)">
			<title>子流程</title>
			<desc>展开字符串中的宏</desc>
			<path d="M0 706.67 L128.98 706.67 L128.98 678.33 L0 678.33 L0 706.67 Z" class="st9"/>
			<path d="M0 706.67 L128.98 706.67 L128.98 678.33 L0 678.33 L0 706.67" class="st10"/>
			<path d="M8.5 706.67 L8.5 678.33" class="st10"/>
			<path d="M120.47 706.67 L120.47 678.33" class="st10"/>
			<text x="14.09" y="696.1" class="st2">展开字符串中的宏</text>		</g>
		<g id="shape64-56" transform="translate(114.879,-642.547)">
			<title>动态连接线.64</title>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
		</g>
		<g id="shape67-61" transform="translate(57.4773,-554.111)">
			<title>Process.67</title>
			<desc>扫描当前字符串将字符串中的所有待处理宏加入宏列表中</desc>
			<rect x="0" y="650.589" width="128.976" height="56.0855" class="st7"/>
			<text x="7.79" y="667.83" class="st2">扫描当前字符串，将<tspan x="7.79" dy="1.2em" class="st8">字符串中的所有待处</tspan><tspan x="14.09"
						dy="1.2em" class="st8">理宏加入宏列表中</tspan></text>		</g>
		<g id="shape69-66" transform="translate(216.217,-186.844)">
			<title>Process.69</title>
			<desc>进行宏替换</desc>
			<rect x="0" y="678.328" width="128.976" height="28.3465" class="st7"/>
			<text x="32.99" y="696.1" class="st2">进行宏替换</text>		</g>
		<g id="shape101-69" transform="translate(57.4773,-404.369)">
			<title>Process.101</title>
			<desc>取出宏列表中第一个待展开的宏字符串</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">取出宏列表中第一个<tspan x="14.09" dy="1.2em" class="st8">待展开的宏字符串</tspan></text>		</g>
		<g id="shape102-73" transform="translate(192.123,-561.045)">
			<title>工作表.102</title>
			<desc>在这一步中不包含宏参数中嵌套的宏相当于进行字符串分割依次处理每个宏字符子串</desc>
			<rect x="0" y="664.459" width="128.976" height="42.216" class="st11"/>
			<text x="2" y="678.37" class="st12">在这一步中不包含宏参数中嵌套的<tspan x="2" dy="1.2em" class="st8">宏</tspan>，相当于进行字符串分割，依次<tspan
						x="2" dy="1.2em" class="st8">处理每个宏字符子串</tspan></text>		</g>
		<g id="shape105-78" transform="translate(57.4773,-179.757)">
			<title>Decision.105</title>
			<desc>包含宏参数</desc>
			<path d="M0 685.42 L64.49 664.16 L128.98 685.42 L64.49 706.67 L0 685.42 Z" class="st1"/>
			<text x="32.99" y="689.02" class="st2">包含宏参数</text>		</g>
		<g id="shape106-81" transform="translate(57.4773,-329.499)">
			<title>Decision.106</title>
			<desc>已展开过</desc>
			<path d="M0 685.42 L64.49 664.16 L128.98 685.42 L64.49 706.67 L0 685.42 Z" class="st1"/>
			<text x="39.29" y="689.02" class="st2">已展开过</text>		</g>
		<g id="shape107-84" transform="translate(374.958,-329.499)">
			<title>Process.107</title>
			<desc>移除展开此宏时添加的已展开宏记录</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">移除展开此宏时添加<tspan x="20.39" dy="1.2em" class="st8">的已展开宏记录</tspan></text>		</g>
		<g id="shape111-88" transform="translate(114.879,-404.369)">
			<title>动态连接线.111</title>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
		</g>
		<g id="shape112-93" transform="translate(216.217,-329.499)">
			<title>Process.112</title>
			<desc>当前宏字符串处理完成从宏列表中移除</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">当前宏字符串处理完<tspan x="7.79" dy="1.2em" class="st8">成</tspan>，从宏列表中移除</text>		</g>
		<g id="shape113-97" transform="translate(186.454,-343.672)">
			<title>动态连接线.113</title>
			<desc>Y</desc>
			<path d="M0 699.59 L23.6 699.59" class="st3"/>
			<rect x="12.6709" y="694.789" width="4.42172" height="9.59985" class="st5"/>
			<text x="12.67" y="701.99" class="st6">Y</text>		</g>
		<g id="shape119-104" transform="translate(57.4773,-254.628)">
			<title>Process.119</title>
			<desc>将当前宏字符串添加到已展开宏记录中</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">将当前宏字符串添加<tspan x="14.09" dy="1.2em" class="st8">到已展开宏记录中</tspan></text>		</g>
		<g id="shape120-108" transform="translate(114.879,-329.499)">
			<title>动态连接线.120</title>
			<desc>N</desc>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
			<rect x="4.09455" y="718.051" width="5.98425" height="9.59985" class="st5"/>
			<text x="4.09" y="725.25" class="st6">N</text>		</g>
		<g id="shape121-115" transform="translate(114.879,-254.628)">
			<title>动态连接线.121</title>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
		</g>
		<g id="shape122-120" transform="translate(186.454,-208.104)">
			<title>动态连接线.122</title>
			<desc>N</desc>
			<path d="M0 713.76 L23.6 713.76" class="st3"/>
			<rect x="11.8898" y="708.962" width="5.98425" height="9.59985" class="st5"/>
			<text x="11.89" y="716.16" class="st6">N</text>		</g>
		<g id="shape126-127" transform="translate(243.147,-259.059)">
			<title>工作表.126</title>
			<desc>在这一步中只移除展开当前级别宏时添加的记录不移除父级展开时添加的记录</desc>
			<rect x="0" y="668.587" width="128.976" height="38.0881" class="st11"/>
			<text x="2" y="680.43" class="st12">在这一步中只移除展开当前级别宏<tspan x="2" dy="1.2em" class="st8">时添加的记录</tspan>，不移除父级展开时<tspan
						x="2" dy="1.2em" class="st8">添加的记录</tspan></text>		</g>
		<g id="shape128-132" transform="translate(396.926,-172.67)">
			<title>工作表.128</title>
			<desc>嵌套处理字符串宏展开</desc>
			<rect x="0" y="694.675" width="85.0394" height="12" class="st11"/>
			<text x="2" y="703.07" class="st12">嵌套处理字符串宏展开</text>		</g>
		<g id="shape129-135" transform="translate(345.194,-193.93)">
			<title>动态连接线.129</title>
			<path d="M0 699.59 L23.6 699.59" class="st3"/>
		</g>
		<g id="shape130-140" transform="translate(374.958,-404.369)">
			<title>Process.130</title>
			<desc>向后扫描一个token形成一个新的字符串</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="2.47" y="681.82" class="st13">向后<tspan class="st14">扫描一个</tspan><tspan class="st14">token</tspan><tspan
						class="st14">，</tspan><tspan x="7.79" dy="1.2em" class="st14">形成一个新的字符串</tspan></text>		</g>
		<g id="shape132-147" transform="translate(216.217,-404.369)">
			<title>Decision.132</title>
			<desc>产生新宏</desc>
			<path d="M0 685.42 L64.49 664.16 L128.98 685.42 L64.49 706.67 L0 685.42 Z" class="st1"/>
			<text x="39.29" y="689.02" class="st2">产生新宏</text>		</g>
		<g id="shape133-150" transform="translate(374.958,-432.716)">
			<title>动态连接线.133</title>
			<path d="M0 713.76 L-23.6 713.76" class="st3"/>
		</g>
		<g id="shape134-155" transform="translate(216.217,-486.327)">
			<title>Process.134</title>
			<desc>添加到宏列表中</desc>
			<rect x="0" y="678.328" width="128.976" height="28.3465" class="st7"/>
			<text x="20.39" y="696.1" class="st2">添加到宏列表中</text>		</g>
		<g id="shape135-158" transform="translate(216.217,-425.629)">
			<title>动态连接线.135</title>
			<desc>N</desc>
			<path d="M0 706.67 L-10.63 706.67 L-10.63 631.8 L-23.6 631.8" class="st3"/>
			<rect x="-13.622" y="660.188" width="5.98425" height="9.59985" class="st5"/>
			<text x="-13.62" y="667.39" class="st6">N</text>		</g>
		<g id="shape136-165" transform="translate(216.217,-493.413)">
			<title>动态连接线.136</title>
			<path d="M0 699.59 L-23.6 699.59" class="st3"/>
		</g>
		<g id="shape137-170" transform="translate(273.619,-446.889)">
			<title>动态连接线.137</title>
			<desc>Y</desc>
			<path d="M7.09 706.67 L7.09 673.4" class="st3"/>
			<rect x="4.87568" y="682.156" width="4.42172" height="9.59985" class="st5"/>
			<text x="4.88" y="689.36" class="st6">Y</text>		</g>
		<g id="shape140-177" transform="translate(374.958,-254.628)">
			<title>Process.140</title>
			<desc>当前宏字符串处理完成从宏列表中移除</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">当前宏字符串处理完<tspan x="7.79" dy="1.2em" class="st8">成</tspan>，从宏列表中移除</text>		</g>
		<g id="shape143-181" transform="translate(280.706,-372.018)">
			<title>动态连接线.143</title>
			<path d="M0 706.67 L0 696.04 L-80.43 696.04 L-80.43 578.19 L-88.09 578.19" class="st3"/>
		</g>
		<g id="shape147-186" transform="translate(192.123,-635.612)">
			<title>工作表.147</title>
			<desc>宏列表没有继承关系初始为空已展开宏记录有继承关系可视为全局变量</desc>
			<rect x="0" y="664.459" width="128.976" height="42.216" class="st11"/>
			<text x="2" y="678.37" class="st12">宏列表没有继承关系，初始为空；<tspan x="2" dy="1.2em" class="st8">已展开宏记录有继承关系</tspan>，可视为<tspan
						x="2" dy="1.2em" class="st8">全局变量</tspan></text>		</g>
		<g id="shape148-191" transform="translate(374.958,-451.209)">
			<title>工作表.148</title>
			<desc>这里的向后扫描的范围为输入字符串不止是宏字符串内</desc>
			<rect x="0" y="678.328" width="128.976" height="28.3465" class="st11"/>
			<text x="2" y="690.1" class="st12">这里的向后扫描的范围为输入字符<tspan x="2" dy="1.2em" class="st8">串</tspan>（不止是宏字符串）内</text>		</g>
		<g id="shape149-195" transform="translate(57.4773,-104.886)">
			<title>Process.149</title>
			<desc>依次取出每个宏参数字符串</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">依次取出每个宏参数<tspan x="45.59" dy="1.2em" class="st8">字符串</tspan></text>		</g>
		<g id="shape150-199" transform="translate(57.4773,-44.1888)">
			<title>子流程.150</title>
			<desc>展开字符串中的宏</desc>
			<path d="M0 706.67 L128.98 706.67 L128.98 678.33 L0 678.33 L0 706.67 Z" class="st9"/>
			<path d="M0 706.67 L128.98 706.67 L128.98 678.33 L0 678.33 L0 706.67" class="st10"/>
			<path d="M8.5 706.67 L8.5 678.33" class="st10"/>
			<path d="M120.47 706.67 L120.47 678.33" class="st10"/>
			<text x="14.09" y="696.1" class="st2">展开字符串中的宏</text>		</g>
		<g id="shape153-205" transform="translate(114.879,-179.757)">
			<title>动态连接线.153</title>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
		</g>
		<g id="shape154-210" transform="translate(114.879,-104.886)">
			<title>动态连接线.154</title>
			<path d="M7.09 706.67 L7.09 732.87" class="st3"/>
		</g>
		<g id="shape155-215" transform="translate(67.3985,-28.8465)">
			<title>工作表.155</title>
			<desc>嵌套处理宏参数字符串宏展开</desc>
			<rect x="0" y="694.675" width="109.134" height="12" class="st11"/>
			<text x="2" y="703.07" class="st12">嵌套处理宏参数字符串宏展开</text>		</g>
		<g id="shape156-218" transform="translate(216.217,-37.1022)">
			<title>Process.156</title>
			<desc>在宏替换内容中寻找参数列表中的token</desc>
			<rect x="0" y="664.155" width="128.976" height="42.5197" class="st7"/>
			<text x="7.79" y="681.82" class="st2">在宏替换内容中寻找<tspan x="8.77" dy="1.2em" class="st8">参数列表中的</tspan>token</text>		</g>
		<g id="shape157-222" transform="translate(186.454,-51.2754)">
			<title>动态连接线.157</title>
			<path d="M0 699.59 L23.6 699.59" class="st3"/>
		</g>
		<g id="shape158-227" transform="translate(345.194,-51.2754)">
			<title>动态连接线.158</title>
			<path d="M0 699.59 L37.07 699.59" class="st3"/>
		</g>
		<g id="shape159-232" transform="translate(439.446,-79.6219)">
			<title>动态连接线.159</title>
			<desc>Y</desc>
			<path d="M0 706.67 L0 696.04 L-83.62 696.04 L-83.62 660.15 L-88.09 660.15" class="st3"/>
			<rect x="-61.9691" y="691.245" width="4.42172" height="9.59985" class="st5"/>
			<text x="-61.97" y="698.45" class="st6">Y</text>		</g>
		<g id="shape160-239" transform="translate(273.619,-147.406)">
			<title>动态连接线.160</title>
			<path d="M7.09 706.67 L7.09 673.4" class="st3"/>
		</g>
		<g id="shape161-244" transform="translate(439.446,-147.406)">
			<title>动态连接线.161</title>
			<path d="M0 706.67 L0 696.04 L-158.74 696.04 L-158.74 673.4" class="st3"/>
		</g>
		<g id="shape162-249" transform="translate(432.359,-215.19)">
			<title>动态连接线.162</title>
			<path d="M7.09 706.67 L7.09 673.4" class="st3"/>
		</g>
		<g id="shape163-254" transform="translate(432.359,-297.147)">
			<title>动态连接线.163</title>
			<path d="M7.09 706.67 L7.09 680.48" class="st3"/>
		</g>
		<g id="shape164-259" transform="translate(432.359,-372.018)">
			<title>动态连接线.164</title>
			<path d="M7.09 706.67 L7.09 680.48" class="st3"/>
		</g>
	</g>
</svg>
